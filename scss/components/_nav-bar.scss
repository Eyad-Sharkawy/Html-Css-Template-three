// ============================================================================
// Navigation Bar Component
// ============================================================================

@use "../helpers/mixins" as *;
@use "../helpers/variables" as *;

.nav-bar {
  background-color: var(--background-white);
  position: fixed; // Fixed position to overlay content
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000; // Ensures nav stays above other content
  box-shadow: 0 2px 5px var(--shadow-nav); // Subtle shadow

  &__container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative; // Needed for absolute positioning of hamburger menu
    
    // Stack logo and menu vertically on mobile
    @include mobile-only {
      flex-flow: column;
    }
  }

  // Logo/Brand Styling
  &__logo {
    color: var(--main-color);
    font-size: 1.625rem;
    font-weight: bold;
    text-decoration: none;
  }

  // Primary Navigation Menu Container
  &__menu {
    display: flex;
  }

  // Navigation Menu Link Item
  // Used for all main navigation links (Articles, Gallery, Features, Other Links)
  &__nav-link {
    font-size: var(--nav-bar-font);
    position: relative; // Needed for ::before pseudo-element positioning
    display: flex;
    align-items: center;

    // Smaller font size on mobile devices
    @include mobile-only {
      font-size: 0.875rem;
    }

    // Animated top border indicator (appears on hover/active)
    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      background-color: var(--main-color);
      width: 0; // Starts at 0, animates to full width on hover/active
      height: 4px;
      transition: var(--main-transition);
      // Performance optimization for animated pseudo-element
      will-change: width;
    }

    // Active state modifier
    // Applied when menu item is active (e.g., when hamburger menu is open)
    // Must come before hover state to ensure it persists
    &--active {
      background-color: var(--background-light);

      // Expand the top border indicator to full width and keep it visible
      &::before {
        width: 100%;
      }

      // Change link color to main color and ensure it persists
      a {
        color: var(--main-color) !important; // Force it to stay blue
      }
    }

    // Menu Link Styling (base styles)
    a {
      display: block;
      text-decoration: none;
      color: var(--text-black);
      transition: var(--main-transition);
      padding: var(--spacing-nav-padding) var(--spacing-2xl);

      // Reduced padding on mobile for compact layout
      @include mobile-only {
        padding: var(--spacing-nav-padding-mobile);
      }
    }

    // Hover state
    &:hover {
      background-color: var(--background-light);

      // Expand the top border indicator to full width
      &::before {
        width: 100%;
      }

      // Change link color to main color
      a {
        color: var(--main-color);
      }
    }
  }


  // Hamburger Dropdown Menu (Mega Menu)
  // Dropdown menu that appears when "Other Links" is clicked
  &__hamburger {
    position: absolute;
    visibility: hidden; // Hidden by default (better than display: none for transitions)
    display: flex;
    top: calc(100% + var(--spacing-4xl)); // Position below nav bar with gap
    width: 100%;
    gap: var(--spacing-4xl); // Space between image and menu columns
    padding: var(--spacing-2xl);
    background-color: var(--background-white);
    border-top: 1px solid var(--border-gray);
    border-bottom: 3px solid var(--main-color);
    transition: var(--main-transition);

    // Mobile-specific styles
    @include mobile-only {
      padding: var(--spacing-nav-padding-mobile);
      flex-flow: column; // Stack items vertically
      gap: 0; // Remove gap between columns on mobile
      
      // Break out of container to span full viewport width
      // Technique: use viewport width with calculated margin to center
      left: 0;
      right: 0;
      width: 100vw; // Full viewport width
      margin-left: calc(-50vw + 50%); // Centers element relative to viewport
    }

    // Active state: menu is visible
    &--active {
      visibility: visible !important;
      top: 100%; // Slide down to align with nav bar bottom
    }

    // Menu Illustration Image
    &__image {
      img {
        max-width: 100%;
        height: auto; // Maintain aspect ratio
      }

      // Hide image on tablets and smaller screens
      @include mobile-only {
        display: none;
      }
      
      @include tablet-only {
        display: none;
      }
    }

    // Menu Columns Container (two columns of navigation links)
    ul {
      flex: 1; // Equal width columns
      display: flex;
      flex-flow: column;
      min-width: 250px; // Minimum width for desktop

      // Add border between menu columns on mobile
      @include mobile-only {
        &:not(:first-of-type) {
          border-top: 1px solid var(--border-gray); // Separator between first and second column
        }
      }
    }
  }

  // Hamburger Menu Link Item
  // Individual link items inside the hamburger dropdown menu
  &__hamburger-link {
    position: relative; // Needed for ::before pseudo-element
    padding: var(--spacing-md);
    font-size: var(--nav-bar-font);
    font-weight: bold;
    border-bottom: 1px solid var(--border-gray); // Separator between items

    // Remove border from last item in each column
    &:last-child {
      border-bottom: none;
    }

    // Link Styling
    a {
      display: block;
      color: var(--main-color);
      text-decoration: none;
      position: relative;

      // Icon spacing
      i {
        margin-right: var(--spacing-md);
      }
    }

    // Hover background effect (slides in from left)
    &::before {
      content: "";
      position: absolute;
      width: 0; // Starts at 0
      height: 100%;
      top: 0;
      left: 0;
      background-color: var(--background-light);
      transition: var(--main-transition);
      // Performance optimization for animated pseudo-element
      will-change: width;
    }

    // Expand background on hover (slides in from left)
    &:hover::before {
      width: 100%; // Expands to full width
    }
  }
}